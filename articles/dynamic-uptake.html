<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dynamic Uptake • dynamicpv</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Dynamic Uptake">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dynamicpv</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cost-effectiveness-applications.html">Cost Effectiveness Applications</a>
    </li>
    <li>
      <a href="../articles/dynamic-pricing.html">Dynamic Pricing</a>
    </li>
    <li>
      <a href="../articles/dynamic-uptake.html">Dynamic Uptake</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/MSDLLCpapers/dynacem/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Dynamic Uptake</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MSDLLCpapers/dynacem/blob/main/vignettes/dynamic-uptake.Rmd" class="external-link"><code>vignettes/dynamic-uptake.Rmd</code></a></small>
      <div class="hidden name"><code>dynamic-uptake.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="what-is-dynamic-uptake">What is dynamic uptake?<a class="anchor" aria-label="anchor" href="#what-is-dynamic-uptake"></a>
</h2>
<p>The cashflows examined in the Dynamic Pricing vignette all began in
the first timestep, and continued from there. Dynamic uptake occurs if
the same cashflow series may begin at several different times. For
example, suppose we are examining costs of treatment over the course of
treatment. We might wish to summarize costs according to the time since
beginning treatment. If we then wish to examine costs of treatment over
a cohort of multiple patients, we will need to take account of the fact
that different patients may begin treatment at different times.</p>
</div>
<div class="section level2">
<h2 id="using-dynamicpv">Using <em>dynamicpv</em><a class="anchor" aria-label="anchor" href="#using-dynamicpv"></a>
</h2>
<p>First let us load the packages we will use for this vignette.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://MSDLLCpapers.github.io/dynacem/" class="external-link">dynamicpv</a></span><span class="op">)</span></span></code></pre></div>
<p>Let us work with the same cashflow as in the Dynamic Pricing
vignette, but assume all costs/prices are constant in real terms. The
discount rate is 3 % per year, real.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># A simple cashflow</span></span>
<span><span class="va">cashflow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">110</span>, <span class="fl">120</span>, <span class="fl">130</span>, <span class="fl">140</span>, <span class="fl">150</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># (Real) discount rate of 3\% per timestep (year)</span></span>
<span><span class="va">disc</span> <span class="op">&lt;-</span> <span class="fl">0.03</span></span></code></pre></div>
<div class="section level3">
<h3 id="non-dynamic-uptake">Non-dynamic uptake<a class="anchor" aria-label="anchor" href="#non-dynamic-uptake"></a>
</h3>
<p>Uptake is not dynamic if the cashflow series begins at the same time
for everyone.</p>
<table class="table">
<caption>Table: Calculation of NPV from a simple cashflow and given
discount rate {#tbl-onecash}</caption>
<thead><tr class="header">
<th>Time</th>
<th>Cashflow 1</th>
<th>Discount factor</th>
<th>Product</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>t</mi></msub><annotation encoding="application/x-tex">c_t</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>v</mi><mi>t</mi></msup><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">v^t = (1+i)^{-t}</annotation></semantics></math></td>
<td></td>
</tr>
<tr class="even">
<td>1</td>
<td><code>r{cashflow[1]}</code></td>
<td><code>r{vt1[1]}</code></td>
<td><code>r{cashflow[1] * vt1[1]}</code></td>
</tr>
<tr class="odd">
<td>2</td>
<td><code>r{cashflow[2]}</code></td>
<td><code>r{vt1[2]}</code></td>
<td><code>r{cashflow[2] * vt1[2]}</code></td>
</tr>
<tr class="even">
<td>3</td>
<td><code>r{cashflow[3]}</code></td>
<td><code>r{vt1[3]}</code></td>
<td><code>r{cashflow[3] * vt1[3]}</code></td>
</tr>
<tr class="odd">
<td>4</td>
<td><code>r{cashflow[4]}</code></td>
<td><code>r{vt1[4]}</code></td>
<td><code>r{cashflow[4] * vt1[4]}</code></td>
</tr>
<tr class="even">
<td>5</td>
<td><code>r{cashflow[5]}</code></td>
<td><code>r{vt1[5]}</code></td>
<td><code>r{cashflow[5] * vt1[5]}</code></td>
</tr>
<tr class="odd">
<td>——</td>
<td>———-</td>
<td>——————–</td>
<td>———</td>
</tr>
<tr class="even">
<td>Total</td>
<td><code>r{sum(cashflow)}</code></td>
<td></td>
<td><code>r{sum(vt1 * cashflow)}</code></td>
</tr>
</tbody>
</table>
<p>In this case, all cashflow series start at timestep 1.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Uptake vector is simple</span></span>
<span><span class="va">uptakes</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># NPV calculation</span></span>
<span><span class="va">pv1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dynpv.html">dynpv</a></span><span class="op">(</span>payoffs<span class="op">=</span><span class="va">cashflow</span>, uptakes<span class="op">=</span><span class="va">uptakes</span>, discrate<span class="op">=</span><span class="va">disc</span><span class="op">)</span></span>
<span><span class="va">pv1</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">total</span></span>
<span><span class="co">#&gt; [1] 610.4352</span></span></code></pre></div>
<p>The result is unchanged from the Dynamic Pricing vignette, where we
also showed the function could be verified with some simple vector
arithmetic.</p>
</div>
<div class="section level3">
<h3 id="dynamic-uptake-constant-in-time-unweighted">Dynamic uptake, constant in time (unweighted)<a class="anchor" aria-label="anchor" href="#dynamic-uptake-constant-in-time-unweighted"></a>
</h3>
<p>Suppose we have one new patient each year, and we wish to calculate
the total NPV in a time horizon of 5 years. Now we have a payoff
triangle. This is similar to the idea of run-off triangles that general
insurance actuaries use to model the emergence of insurance claims over
time.</p>
<table class="table">
<caption>Table: Calculation of NPV from a simple cashflow and given
discount rate {#tbl-tri}</caption>
<thead><tr class="header">
<th>Time</th>
<th>Cashflow 1</th>
<th>Cashflow 2</th>
<th>Cashflow 3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>t</mi></msub><annotation encoding="application/x-tex">c_t</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>v</mi><mi>t</mi></msup><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">v^t = (1+i)^{-t}</annotation></semantics></math></td>
<td></td>
</tr>
<tr class="even">
<td>1</td>
<td><code>r{cashflow[1]}</code></td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>2</td>
<td><code>r{cashflow[2]}</code></td>
<td><code>r{cashflow[1]}</code></td>
<td>0</td>
</tr>
<tr class="even">
<td>3</td>
<td><code>r{cashflow[3]}</code></td>
<td><code>r{cashflow[2]}</code></td>
<td><code>r{cashflow[1]}</code></td>
</tr>
<tr class="odd">
<td>4</td>
<td><code>r{cashflow[4]}</code></td>
<td><code>r{cashflow[3]}</code></td>
<td><code>r{cashflow[2]}</code></td>
</tr>
<tr class="even">
<td>5</td>
<td><code>r{cashflow[5]}</code></td>
<td><code>r{cashflow[4]}</code></td>
<td><code>r{cashflow[3]}</code></td>
</tr>
<tr class="odd">
<td>——</td>
<td>———-</td>
<td>——————–</td>
<td>———</td>
</tr>
<tr class="even">
<td>Total</td>
<td><code>r{sum(cashflow)}</code></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>There are 5 patients with a total NPV of
<code>r{dynpv(payoffs=cashflow, uptakes=uptakes, discrate=disc)$results$total}</code>,
which equates to
<code>r{dynpv(payoffs=cashflow, uptakes=uptakes, discrate=disc)$results$mean}</code>
on average per patient.</p>
<p>As before, using <em>dynamicpv</em> to calculate this simple example
is rather overkill, but hopefully illustrates the value of the
solution.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vt</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">disc</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">vt</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">cashflow</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1707.723</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dynamic-uptake-not-constant-in-time">Dynamic uptake, not constant in time<a class="anchor" aria-label="anchor" href="#dynamic-uptake-not-constant-in-time"></a>
</h3>
<p>In general, uptake will not be constant in time. Due to factors such
as varying epidemiology (prevalence and incidence), prior treatment
pathways (patient testing, patient diagnostics, prior treatment usage),
as well as the specific uptake of the treatment of interest (patient
share), uptake will also be highly variable over time. In this setting,
the total and mean NPVs must reflect weightings applicable to each
cashflow.</p>
<p>For example, suppose the number of patients receiving treatment
increases by one each year. The weighting given to cashflow 1 would then
be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mn>2</mn><mo>+</mo><mn>3</mn><mo>+</mo><mn>4</mn><mo>+</mo><mn>5</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>6.67</mn></mrow><annotation encoding="application/x-tex">1/(1+2+3+4+5)=6.67</annotation></semantics></math>
%.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Uptake vector is simple</span></span>
<span><span class="va">uptakes</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span></span>
<span></span>
<span><span class="co"># NPV calculation</span></span>
<span><span class="va">pv2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dynpv.html">dynpv</a></span><span class="op">(</span>payoffs<span class="op">=</span><span class="va">cashflow</span>, uptakes<span class="op">=</span><span class="va">uptakes</span>, discrate<span class="op">=</span><span class="va">disc</span><span class="op">)</span></span>
<span><span class="va">pv2</span><span class="op">$</span><span class="va">results</span></span>
<span><span class="co">#&gt; $ncoh</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $uptake</span></span>
<span><span class="co">#&gt; [1] 15</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $calc</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 15 × 9</span></span></span>
<span><span class="co">#&gt;        j     k     l     t    uj    pk     R     v    pv</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1     1     0     1     1   110     1 1      110 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1     2     0     2     1   120     1 0.971  117.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     1     3     0     3     1   130     1 0.943  123.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1     4     0     4     1   140     1 0.915  128.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     1     5     0     5     1   150     1 0.888  133.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     2     1     0     2     2   110     1 0.971  214.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     2     2     0     3     2   120     1 0.943  226.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     2     3     0     4     2   130     1 0.915  238.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     2     4     0     5     2   140     1 0.888  249.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     3     1     0     3     3   110     1 0.943  311.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>     3     2     0     4     3   120     1 0.915  329.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>     3     3     0     5     3   130     1 0.888  347.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>     4     1     0     4     4   110     1 0.915  403.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>     4     2     0     5     4   120     1 0.888  426.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>     5     1     0     5     5   110     1 0.888  489.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cohpv</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 3</span></span></span>
<span><span class="co">#&gt;       j tzero   spv</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1     0  610.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     2     0  927.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     3     0  987.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     4     0  829.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     5     0  489.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $total</span></span>
<span><span class="co">#&gt; [1] 3841.785</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt; [1] 256.119</span></span>
<span></span>
<span><span class="co"># Verify total NPV</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">vt</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">cashflow</span><span class="op">)</span> <span class="op">*</span> <span class="va">uptakes</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 6292.472</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dynamic-pricing-and-uptake">Dynamic pricing and uptake<a class="anchor" aria-label="anchor" href="#dynamic-pricing-and-uptake"></a>
</h3>
<p>The package becomes most powerful when considering both dynamic
uptake and dynamic pricing. A simple call to
<code><a href="../reference/dynpv.html">dynamicpv::dynpv()</a></code> replaces what would be rather more
complicated with base functions, even in this toy example.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Price index</span></span>
<span><span class="va">pinfl</span> <span class="op">&lt;-</span> <span class="fl">0.01</span></span>
<span><span class="va">pindex</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">pinfl</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">pindex</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span></span>
<span><span class="co"># Nominal discount rate</span></span>
<span><span class="va">nomdisc</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">disc</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">pinfl</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span></span>
<span></span>
<span><span class="co"># NPV calculation</span></span>
<span><span class="va">pv2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dynpv.html">dynpv</a></span><span class="op">(</span>payoffs<span class="op">=</span><span class="va">cashflow</span>, uptakes<span class="op">=</span><span class="va">uptakes</span>, prices<span class="op">=</span><span class="va">pindex</span>, discrate<span class="op">=</span><span class="va">nomdisc</span><span class="op">)</span></span>
<span><span class="va">pv2</span><span class="op">$</span><span class="va">results</span></span>
<span><span class="co">#&gt; $ncoh</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $uptake</span></span>
<span><span class="co">#&gt; [1] 15</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $calc</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 15 × 9</span></span></span>
<span><span class="co">#&gt;        j     k     l     t    uj    pk     R     v    pv</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1     1     0     1     1   110  1    1     110  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1     2     0     2     1   120  1.01 0.961 117. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     1     3     0     3     1   130  1.02 0.924 123. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1     4     0     4     1   140  0.5  0.888  62.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     1     5     0     5     1   150  1.04 0.854 133. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     2     1     0     2     2   110  1.01 0.961 214. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     2     2     0     3     2   120  1.02 0.924 226. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     2     3     0     4     2   130  0.5  0.888 115. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     2     4     0     5     2   140  1.04 0.854 249. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     3     1     0     3     3   110  1.02 0.924 311. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>     3     2     0     4     3   120  0.5  0.888 160. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>     3     3     0     5     3   130  1.04 0.854 347. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>     4     1     0     4     4   110  0.5  0.888 195. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>     4     2     0     5     4   120  1.04 0.854 426. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>     5     1     0     5     5   110  1.04 0.854 489. </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cohpv</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 3</span></span></span>
<span><span class="co">#&gt;       j tzero   spv</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1     0  544.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     2     0  804.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     3     0  817.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     4     0  622.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     5     0  489.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $total</span></span>
<span><span class="co">#&gt; [1] 3276.552</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt; [1] 218.4368</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<ul>
<li>Dynamic uptake occurs if the same cashflow series may begin at
several different times, as can occur when modeling costs of treatment
to populations over time (where uptake of that treatment varies in time)
or the run-off of insurance claims. This can complicate calculations of
NPV.</li>
<li>The <code><a href="../reference/dynpv.html">dynamicpv::dynpv()</a></code> function can be used to
calculate NPVs for arbitrary vectors of cashflows, at a given discount
rate and a given expected uptake over time.</li>
<li>In this way, the function can accommodate both dynamic uptake and,
as seen in the previous vignette, dynamic pricing.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Dominic Muston, Merck &amp; Co., Inc., Rahway, NJ, USA and its affiliates.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
